<style>
    body {
        background-color: black;
        color: orange;
        margin: 0;
    }

    #movieContainer {
        max-width: 100%; 
    }

    #filmName {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
    }

    #detailedFilmName {
        font-size: 18px;
        margin-bottom: 10px;
    }
</style>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/12/12096.png" type="image/png">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>axaxpoisk</title>
    <style>
        #detailedFilmName {
            font-size: 24px;
            font-weight: bold;
            font-style: inherit;
        }
        #description {
            font-size: 18px;
            font-style: inherit;
            max-width: 600;
            color: rgb(217, 231, 19);
        }
        #shortdescription {
            font-size: 18px;
            font-style: inherit;
            max-width: 600;
            color: rgb(24, 209, 169);
        }
        #year {
            font-size: 18px;
            font-style: inherit;
            max-width: 600;
            color: rgb(228, 12, 12)
        }
        #slogan {
            font-size: 18px;
            font-style: inherit;
            max-width: 600;
            color: rgb(21, 206, 36)
        }
    </style>
</head>

<body>
    <div id="filmName"></div>
    <input type="text" id="movieIdInput" placeholder="ID s kinopoiska" inputmode="numeric" pattern="[0-9]*">
    <button onclick="getMovieData()">view</button>
    <div id="detailedFilmName"></div>
    <div id="movieContainer"></div>
    <div id="year"></div>
    <br><div id="shortdescription"></div></br>
    <div id="description"></div>
   <br> <div id="slogan"></div></br>
    <script>
        $(document).ready(function () {
            // Load movie from URL when the page loads
            loadMovieFromURL();
        });

        function loadMovieFromURL() {
            const movieIdFromURL = getParameterByName('');
            if (movieIdFromURL) {
                $('#movieIdInput').val(movieIdFromURL);
                getMovieData();
            }
        }

        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        function getMovieData() {
    const movieIdValue = $('#movieIdInput').val();
    $.ajax({
        url: 'https://w3w.kpfr.cc/kinobox/index.php',
        crossDomain: true,
        data: {
            'kinopoisk': movieIdValue
        }
    }).done(function (response) {
        console.log(response);


        if (response.data && response.data.length > 0) {
            const iframeUrl = response.data[0].iframeUrl;
            const movieId = extractMovieId(iframeUrl);
            const filmName = response.data[0].nameRu;

            viewMovie(movieId);
            displayFilmName(filmName);
            getMovieDetails(movieIdValue);
        } else {

            console.error('No movie data found');

        }
    });
}

        function extractMovieId(iframeUrl) {
            const urlParts = iframeUrl.split('/');
            return urlParts[urlParts.length - 1];
        }

        function viewMovie(movieId) {
            const iframeUrl = `https://api.embr.ws/embed/movie/${movieId}`;
            const iframe = `<iframe src="${iframeUrl}" width="600" height="450" frameborder="0" allowfullscreen></iframe>`;
            document.getElementById('movieContainer').innerHTML = iframe;
        }

        function displayFilmName(filmName) {
            document.getElementById('filmName')
        }

        function getMovieDetails(movieId) {
            $.ajax({
                url: `https://kinopoiskapiunofficial.tech/api/v2.2/films/${movieId}`,
                crossDomain: true,
                headers: {
                    'x-api-key': 'c20595a1-3d8c-4cbd-92eb-fd7b0fa75c67'
                },
                contentType: 'application/json'
            }).done(function (response) {
                console.log(response);
                const detailedFilmName = response.nameRu;
                const description = response.description;
                const year = response.year;
                const slogan = response.slogan;
                const shortdescription = response.shortDescription;
                displayDetailedFilmName(detailedFilmName);
                displaydescription(description);
                displayyear(year);
                displayslogan(slogan);
                displayshortdescription(shortdescription);
            });
        }

        function displayDetailedFilmName(detailedFilmName) {
    const element = document.getElementById('detailedFilmName');
    if (detailedFilmName !== null) {
        element.innerHTML = `${detailedFilmName}`;
    } else {
        element.innerHTML = ''; 
    }
}

function displaydescription(description) {
    const element = document.getElementById('description');
    if (description !== null) {
        element.innerHTML = `${description}`;
    } else {
        element.innerHTML = '';
    }
}

function displayyear(year) {
    const element = document.getElementById('year');
    if (year !== null) {
        element.innerHTML = `${year}`;
    } else {
        element.innerHTML = '';
    }
}

function displayslogan(slogan) {
    const element = document.getElementById('slogan');
    if (slogan !== null) {
        element.innerHTML = `${slogan}`;
    } else {
        element.innerHTML = '';
    }
}

function displayshortdescription(shortdescription) {
    const element = document.getElementById('shortdescription');
    if (shortdescription !== null) {
        element.innerHTML = `${shortdescription}`;
    } else {
        element.innerHTML = '';
    }
}
    </script>
    
</body>

</html>
