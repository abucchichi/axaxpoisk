<style>
    body {
        background-color: black;
        color: purple;
        margin: 0; /* Remove default margin */
    }

    #movieContainer {
        max-width: 100%; /* Make sure the container doesn't overflow on small screens */
    }
</style>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>axaxpoisk</title>
</head>

<body>
    <h1>xaxa</h1>
    <input type="text" id="movieIdInput" placeholder="ID s kinopoiska" inputmode="numeric" pattern="[0-9]*">
    <button onclick="getMovieData()">view</button>
    <div id="movieContainer"></div>

    <script>
        // Function to get URL parameter by name
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Function to check if movie ID is in the URL and load it
        function loadMovieFromURL() {
            const movieIdFromURL = getParameterByName('kinopoisk');
            if (movieIdFromURL) {
                $('#movieIdInput').val(movieIdFromURL);
                getMovieData();
            }
        }

        // Load movie from URL when the page loads
        $(document).ready(function () {
            loadMovieFromURL();
        });

        function getMovieData() {
            const movieIdValue = $('#movieIdInput').val();
            $.ajax({
                url: 'https://w2w.kpfr.cc/kinobox/index.php',
                crossDomain: true,
                data: {
                    'kinopoisk': movieIdValue
                }
            }).done(function (response) {
                console.log(response);
                const iframeUrl = response.data[0].iframeUrl;
                const movieId = extractMovieId(iframeUrl);

                viewMovie(movieId);
            });
        }

        function extractMovieId(iframeUrl) {
            const urlParts = iframeUrl.split('/');
            return urlParts[urlParts.length - 1];
        }

        function viewMovie(movieId) {
            const iframeUrl = `https://api.embr.ws/embed/movie/${movieId}`;
            const iframe = `<iframe src="${iframeUrl}" width="1280" height="720" frameborder="0" allowfullscreen></iframe>`;
            document.getElementById('movieContainer').innerHTML = iframe;
        }
    </script>
</body>

</html>
